<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gtech Mobile</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .header-text {
            color: #a0a0a0;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .header-actions {
            display: flex;
            gap: 15px;
        }

        .header-btn {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
        }

        .user-info {
            text-align: center;
            padding: 30px 20px;
        }

        .user-name {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .balance-section {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 30px;
        }

        .balance-item {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 18px;
            color: #a0a0a0;
        }

        .coin-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(45deg, #f39c12, #f1c40f);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .ticket-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(45deg, #e67e22, #f39c12);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .balance-value {
            color: #f39c12;
            font-weight: bold;
        }

        .main-actions {
            padding: 0 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }

        .action-btn {
            background: linear-gradient(45deg, #8b4513, #d2691e);
            border: none;
            border-radius: 20px;
            padding: 18px 30px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .gift-btn {
            background: linear-gradient(45deg, #2c3e50, #34495e);
        }

        .action-icon {
            font-size: 20px;
        }

        .grid-section {
            padding: 0 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .grid-item {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 140px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .grid-item:first-child {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .grid-item:last-child {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .grid-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }

        .grid-icon {
            font-size: 24px;
            margin-bottom: 15px;
        }

        .grid-title {
            font-size: 14px;
            font-weight: bold;
            text-transform: uppercase;
            line-height: 1.3;
        }

        .bottom-actions {
            padding: 0 20px 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .bottom-btn {
            background: rgba(255,255,255,0.05);
            border: none;
            border-radius: 20px;
            padding: 18px 30px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .bottom-btn:hover {
            background: rgba(255,255,255,0.1);
            transform: translateY(-2px);
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal-content {
            background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            border-radius: 25px;
            padding: 30px;
            width: 100%;
            max-width: 400px;
            position: relative;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 5px;
        }

        .modal-subtitle {
            color: #a0a0a0;
            font-size: 14px;
            text-align: center;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        /* –ë–æ–Ω—É—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ */
        .bonus-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .bonus-day {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .bonus-day.active {
            background: rgba(241, 196, 15, 0.2);
            border-color: #f1c40f;
        }

        .bonus-day.claimed {
            background: rgba(46, 204, 113, 0.2);
            border-color: #2ecc71;
        }

        .bonus-day-number {
            font-size: 12px;
            color: #a0a0a0;
            margin-bottom: 5px;
        }

        .bonus-reward {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            font-size: 14px;
            font-weight: bold;
        }

        .timer-info {
            text-align: center;
            color: #a0a0a0;
            font-size: 14px;
            margin-bottom: 20px;
        }

        /* –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤ */
        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .rank {
            font-size: 16px;
            font-weight: bold;
            color: #f39c12;
            min-width: 30px;
        }

        .player-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .player-info {
            flex: 1;
        }

        .player-name {
            font-weight: bold;
            margin-bottom: 2px;
        }

        .player-score {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #f39c12;
            font-size: 14px;
        }

        /* –ü—Ä–æ–º–æ–∫–æ–¥ —Ñ–æ—Ä–º–∞ */
        .promo-form {
            margin-bottom: 20px;
        }

        .promo-input {
            width: 100%;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 15px;
            color: white;
            font-size: 16px;
            margin-bottom: 15px;
        }

        .promo-input::placeholder {
            color: #666;
        }

        .promo-submit {
            width: 100%;
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            border: none;
            border-radius: 15px;
            padding: 15px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
        }

        /* –ú–∞–≥–∞–∑–∏–Ω –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ */
        .shop-categories {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .shop-category {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .shop-category:nth-child(1) {
            background: linear-gradient(135deg, #8b4513 0%, #d2691e 100%);
        }

        .shop-category:nth-child(2) {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        .shop-category:nth-child(3) {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
        }

        .shop-category:nth-child(4) {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        }

        .shop-category:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }

        .shop-icon {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .shop-title {
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
            line-height: 1.3;
        }

        /* –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å */
        .admin-panel {
            background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
            border-radius: 20px;
            padding: 20px;
            margin: 20px;
            display: none;
        }

        .admin-panel.show {
            display: block;
        }

        .admin-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .admin-stat {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
        }

        .admin-stat-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .admin-stat-label {
            font-size: 12px;
            opacity: 0.8;
        }

        .admin-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .admin-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 15px;
            padding: 12px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        /* –ê–¥–º–∏–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ —Ö–µ–¥–µ—Ä–µ */
        .admin-indicator {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            cursor: pointer;
        }

        /* –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .detailed-stats {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ */
        .user-management {
            max-height: 300px;
            overflow-y: auto;
        }

        .user-item {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-actions {
            display: flex;
            gap: 5px;
        }

        .user-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 8px;
            padding: 5px 10px;
            color: white;
            font-size: 12px;
            cursor: pointer;
        }

        /* Download buttons */
        .download-section {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .download-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 20px;
            padding: 18px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .download-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .telegram-btn {
            background: linear-gradient(45deg, #0088cc, #0066cc);
        }

        .appgallery-btn {
            background: linear-gradient(45deg, #c6426e, #e74c3c);
        }

        .rustore-btn {
            background: linear-gradient(45deg, #007bff, #0056b3);
        }

        /* Responsive */
        @media (max-width: 400px) {
            .grid-section {
                grid-template-columns: 1fr;
            }
            
            .bonus-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .shop-categories {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω -->
    <div id="mainScreen">
        <header class="header">
            <div class="logo-section">
                <div class="logo" id="logoClick" onclick="handleLogoClick()">
                    <span style="font-size: 20px;">‚ñ≤</span>
                </div>
                <div class="header-text">–°–∏—Å—Ç–µ–º–∞<br>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π</div>
            </div>
            <div class="header-actions">
                <div id="adminIndicator" style="display: none;" onclick="toggleAdminPanel()">
                    <div class="admin-indicator">üëë</div>
                </div>
                <button class="header-btn">‚ãØ</button>
                <button class="header-btn" onclick="closeApp()">‚úï</button>
            </div>
        </header>

        <div class="user-info">
            <div class="user-name" id="userName">–í–ê–ù–Ø –§–ò–õ–ê–¢–û–í</div>
            
            <div class="balance-section">
                <div class="balance-item">
                    <span>–í–ê–® –ë–ê–õ–ê–ù–°:</span>
                    <div class="coin-icon">‚ÇΩ</div>
                    <span class="balance-value" id="balance">0</span>
                </div>
                <div class="balance-item">
                    <span>–ë–ò–õ–ï–¢–û–í:</span>
                    <div class="ticket-icon">üé´</div>
                    <span class="balance-value" id="tickets">0</span>
                </div>
            </div>
        </div>

        <div class="main-actions">
            <button class="action-btn" onclick="openModal('downloadModal')">
                <span class="action-icon">‚¨á</span>
                –°–ö–ê–ß–ê–¢–¨ –ò–ì–†–£
            </button>
            <button class="action-btn gift-btn" onclick="openModal('bonusModal')">
                <span class="action-icon">üéÅ</span>
                –ü–û–õ–£–ß–ò–¢–¨ –ü–û–î–ê–†–û–ö
            </button>
        </div>

        <div class="grid-section">
            <div class="grid-item" onclick="openModal('leaderboardModal')">
                <div class="grid-icon">üìä</div>
                <div class="grid-title">–¢–û–ü –ê–ö–¢–ò–í–ù–´–•<br>–ò–ì–†–û–ö–û–í</div>
            </div>
        </div>

        <div class="bottom-actions">
            <button class="bottom-btn" onclick="openModal('bonusModal')">
                <span class="action-icon">üéÅ</span>
                –ë–û–ù–£–°–ù–´–ï –ú–û–ù–ï–¢–´
            </button>
            <button class="bottom-btn" onclick="openModal('promoModal')">
                <span class="action-icon">üè∑Ô∏è</span>
                –í–í–ï–°–¢–ò –ü–†–û–ú–û–ö–û–î
            </button>
            <button class="bottom-btn" onclick="openExchangeModal()">
                <span class="action-icon">üîÑ</span>
                –û–ë–ú–ï–ù –†–£–ë–õ–ï–ô –ù–ê –ë–ò–õ–ï–¢–´
            </button>
            <button class="bottom-btn" onclick="openWithdrawModal()">
                <span class="action-icon">üí∏</span>
                –í–´–í–û–î –ë–ò–õ–ï–¢–û–í
            </button>
        </div>
    </div>

   <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-title">üëë –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨</div>
        
        <div class="detailed-stats">
            <div class="stat-row">
                <span>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</span>
                <span id="adminUserCount">0</span>
            </div>
            <div class="stat-row">
                <span>–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ–≥–æ–¥–Ω—è:</span>
                <span id="adminActiveToday">0</span>
            </div>
            <div class="stat-row">
                <span>–û–±—â–∏–π –±–∞–ª–∞–Ω—Å:</span>
                <span id="adminTotalBalance">0</span>
            </div>
            <div class="stat-row">
                <span>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤:</span>
                <span id="adminPromosUsed">0</span>
            </div>
            <div class="stat-row">
                <span>–î–æ—Å—Ç—É–ø–Ω–æ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤:</span>
                <span id="adminPromoCount">0</span>
            </div>
        </div>

        <div class="admin-actions">
            <button class="admin-btn" onclick="showCreatePromo()">üìù –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</button>
            <button class="admin-btn" onclick="showUserManagement()">üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</button>
            <button class="admin-btn" onclick="showPromoManagement()">üé´ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏</button>
            <button class="admin-btn" onclick="manageLeaderboard()">üèÜ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–æ–º</button>
            <button class="admin-btn" onclick="showLinkManagement()">üîó –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∞–º–∏</button>
            <button class="admin-btn" onclick="manageAdmins()">üõ°Ô∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã</button>
            <button class="admin-btn" onclick="showWithdrawRequests()">üí∏ –ó–∞–ø—Ä–æ—Å—ã –≤—ã–≤–æ–¥–æ–≤</button>
            <button class="admin-btn" onclick="toggleWithdrawals()">üîå –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤—ã–≤–æ–¥—ã</button>
            <button class="admin-btn" onclick="exportData()">üìä –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
            <button class="admin-btn" onclick="resetLeaderboard()" style="background: rgba(231, 76, 60, 0.3);">üîÑ –°–ë–†–û–° –õ–ò–î–ï–†–ë–û–†–î–ê</button>
            <button class="admin-btn" onclick="toggleAdminPanel()" style="background: rgba(255,255,255,0.1);">‚ùå –ó–∞–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è -->
    <div class="modal" id="downloadModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–ö–ê–ö –ù–ê–ß–ê–¢–¨ –ò–ì–†–ê–¢–¨</div>
                <button class="close-btn" onclick="closeModal('downloadModal')">‚úï</button>
            </div>
            <div class="modal-subtitle">
                –ß–¢–û–ë–´ –ù–ê–ß–ê–¢–¨ –ò–ì–†–ê–¢–¨ –ù–ê –ù–ê–®–ï–ú –ü–†–û–ï–ö–¢–ï - –ù–ï–û–ë–•–û–î–ò–ú–û –°–ö–ê–ß–ê–¢–¨ –ò –£–°–¢–ê–ù–û–í–ò–¢–¨ –õ–ê–£–ù–ß–ï–† –ò –ó–ê–ü–£–°–¢–ò–¢–¨ –ï–ì–û, –í–°–Æ –ó–ê–ì–†–£–ó–ö–£ –ò –£–°–¢–ê–ù–û–í–ö–£ –ò–ì–†–´ –õ–ê–£–ù–ß–ï–† –°–î–ï–õ–ê–ï–¢ –°–ê–ú
            </div>
            <div class="modal-subtitle">
                –°–ö–ê–ß–ê–ô –ò –£–°–¢–ê–ù–û–í–ò –õ–ê–£–ù–ß–ï–†, –î–û–ñ–î–ò–°–¨ –ó–ê–ì–†–£–ó–ö–ò –§–ê–ô–õ–û–í –ò –ù–ê–ß–ù–ò –ò–ì–†–ê–¢–¨!
            </div>
            <div class="download-section">
                <button class="download-btn telegram-btn" onclick="downloadTelegram()">
                    üì± TELEGRAM
                </button>
                <button class="download-btn appgallery-btn" onclick="downloadAppGallery()">
                    üì± VK
                </button>
                <button class="download-btn rustore-btn" onclick="downloadRuStore()">
                    üì± Discord
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±–æ–Ω—É—Å–æ–≤ -->
    <div class="modal" id="bonusModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–ë–û–ù–£–°–ù–´–ï –ú–û–ù–ï–¢–´</div>
                <button class="close-btn" onclick="closeModal('bonusModal')">‚úï</button>
            </div>
            <div class="modal-subtitle">–ó–∞—Ö–æ–¥–∏—Ç–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –∏ –∑–∞–±–∏—Ä–∞–π—Ç–µ –±–æ–Ω—É—Å—ã.</div>
            
            <div class="timer-info" id="bonusTimer">
                –ú–æ–∂–Ω–æ –∑–∞–±—Ä–∞—Ç—å –±–æ–Ω—É—Å —á–µ—Ä–µ–∑: 23—á. 59–º. 48—Å–µ–∫.
            </div>
            
            <div class="bonus-grid" id="bonusGrid">
                <!-- –î–Ω–∏ –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è JavaScript -->
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ–º–æ–∫–æ–¥–∞ -->
    <div class="modal" id="promoModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–í–í–ï–°–¢–ò –ü–†–û–ú–û–ö–û–î</div>
                <button class="close-btn" onclick="closeModal('promoModal')">‚úï</button>
            </div>
            <div class="modal-subtitle">–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø—Ä–æ–º–æ–∫–æ–¥</div>
            <div class="promo-form">
                <input type="text" class="promo-input" id="promoInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 1aA2-3bB4">
                <button class="promo-submit" onclick="activatePromo()">–ü–†–ò–ú–ï–ù–ò–¢–¨</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ -->
    <div class="modal" id="leaderboardModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–¢–û–ü –ê–ö–¢–ò–í–ù–´–• –ò–ì–†–û–ö–û–í</div>
                <button class="close-btn" onclick="closeModal('leaderboardModal')">‚úï</button>
            </div>
            <div class="modal-subtitle">–í—Å–µ –≤—ã–≤–æ–¥—ã —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ —Å 00:00 –ø–æ 23:00</div>
            
            <div id="leaderboardList">
                <!-- –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è JavaScript -->
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–±–º–µ–Ω–∞ -->
    <div class="modal" id="exchangeModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–û–ë–ú–ï–ù –†–£–ë–õ–ï–ô –ù–ê –ë–ò–õ–ï–¢–´</div>
                <button class="close-btn" onclick="closeModal('exchangeModal')">‚úï</button>
            </div>
            <div class="modal-subtitle">–ö—É—Ä—Å: 10 ‚ÇΩ ‚Üí 2 –±–∏–ª–µ—Ç–∞. –ú–∏–Ω–∏–º—É–º –∫ –æ–±–º–µ–Ω—É: 100 ‚ÇΩ. –°—É–º–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫—Ä–∞—Ç–Ω–∞ 10.</div>
            <input type="number" class="promo-input" id="exchangeAmountInput" placeholder="–°—É–º–º–∞ –≤ ‚ÇΩ (–º–∏–Ω. 100)" oninput="updateExchangeResult()">
            <div class="modal-subtitle" id="exchangeResult">–í—ã –ø–æ–ª—É—á–∏—Ç–µ: 0 –±–∏–ª–µ—Ç–æ–≤</div>
            <button class="promo-submit" onclick="performExchange()">–û–ë–ú–ï–ù–Ø–¢–¨</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–≤–æ–¥–∞ -->
    <div class="modal" id="withdrawModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–í–´–í–û–î –ë–ò–õ–ï–¢–û–í</div>
                <button class="close-btn" onclick="closeModal('withdrawModal')">‚úï</button>
            </div>
            <div class="modal-subtitle" id="withdrawStatusText">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤—ã–≤–æ–¥–æ–≤...</div>
            <input type="text" class="promo-input" id="withdrawNicknameInput" placeholder="–ù–∏–∫ (–∫—É–¥–∞ –∑–∞—á–∏—Å–ª–∏—Ç—å)">
            <input type="number" class="promo-input" id="withdrawTicketsInput" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–ª–µ—Ç–æ–≤ (–º–∏–Ω. 50)">
            <button class="promo-submit" onclick="submitWithdrawalRequest()">–û–¢–ü–†–ê–í–ò–¢–¨ –ó–ê–Ø–í–ö–£</button>
        </div>
    </div>

    <script>
        let appData = {
    user: {
        id: null,
        name: '–ì–û–°–¢–¨', // –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        balance: 0,
        tickets: 0,
        lastBonusDate: null,
        bonusDays: 0,
        usedPromos: [],
        isAdmin: false,
        username: null // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ –¥–ª—è username –∏–∑ Telegram
    },
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            settings: {
                adminIds: [6595683709], // ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ Telegram
                withdrawalsEnabled: true,
                downloadLinks: {
                    telegram: 'https://t.me/gtechmobile',
                    appgallery: 'https://appgallery.huawei.com',
                    rustore: 'https://discord.com'
                }
            },
            users: [],
            promos: [
                { code: '1aA2-3bB4', reward: 100, uses: 0, maxUses: 10, created: new Date().toISOString() },
                { code: 'BONUS2024', reward: 250, uses: 0, maxUses: 5, created: new Date().toISOString() }
            ],
            leaderboard: [
            ],
            withdrawals: [],
            adminClicks: 0,
            statistics: {
                totalUsers: 0,
                totalBalance: 0,
                activeToday: 0,
                promosUsed: 0
            }
        };

        // === –°–µ—Ä–≤–µ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (MySQL —á–µ—Ä–µ–∑ PHP API) ===
        const API_STATE_URL = 'api/state.php';

        async function serverLoadAppState() {
            try {
                const response = await fetch(API_STATE_URL, {
                    method: 'GET',
                    credentials: 'same-origin'
                });
                if (!response.ok) return null;
                const payload = await response.json();
                if (payload && payload.ok && payload.data) {
                    return payload.data;
                }
                return null;
            } catch (err) {
                return null;
            }
        }

        async function serverSaveAppState(state) {
            try {
                await fetch(API_STATE_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'same-origin',
                    body: JSON.stringify(state)
                });
            } catch (err) {
                // ignore network errors, localStorage acts as fallback
            }
        }

        // –í –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞, –≥–¥–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è Telegram WebApp
let tg = window.Telegram?.WebApp;
if (tg) {
    tg.ready();
    tg.expand();
    
    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const user = tg.initDataUnsafe?.user;
    if (user) {
        // –§–æ—Ä–º–∏—Ä—É–µ–º –∏–º—è –∏–∑ first_name –∏ last_name (–µ—Å–ª–∏ –µ—Å—Ç—å)
        let userName = user.first_name || '';
        if (user.last_name) {
            userName += ' ' + user.last_name;
        }
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        appData.user.name = userName.trim().toUpperCase();
        appData.user.id = user.id;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–Ω–∏
        document.getElementById('userName').textContent = appData.user.name;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
        appData.user.isAdmin = appData.settings.adminIds.includes(user.id);
        if (appData.user.isAdmin) {
            showAdminInterface();
        }
    }
}

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î (—á–µ—Ä–µ–∑ API) —Å fallback –Ω–∞ localStorage
        async function loadData() {
            let loadedFromServer = false;
            const serverState = await serverLoadAppState();
            if (serverState) {
                appData = { ...appData, ...serverState };
                loadedFromServer = true;
            }

            if (!loadedFromServer) {
                const saved = localStorage.getItem('miniAppData');
                if (saved) {
                    const parsedData = JSON.parse(saved);
                    appData = { ...appData, ...parsedData };
                }
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –ø–æ–ª—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Å—Ç–∞—Ä—ã—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π
            if (!appData.settings) appData.settings = {};
            if (!Array.isArray(appData.settings.adminIds)) {
                appData.settings.adminIds = [6595683709];
            }
            if (typeof appData.settings.withdrawalsEnabled === 'undefined') {
                appData.settings.withdrawalsEnabled = true;
            }
            if (!appData.settings.downloadLinks) appData.settings.downloadLinks = {};
            appData.settings.downloadLinks.telegram = appData.settings.downloadLinks.telegram || 'https://t.me/gtechmobile';
            appData.settings.downloadLinks.appgallery = appData.settings.downloadLinks.appgallery || 'https://appgallery.huawei.com';
            appData.settings.downloadLinks.rustore = appData.settings.downloadLinks.rustore || 'https://discord.com';
            if (!Array.isArray(appData.withdrawals)) appData.withdrawals = [];
            updateUI();

            generateBonusCalendar();
            generateLeaderboard();
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ MySQL —á–µ—Ä–µ–∑ API (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤)
        function saveData() {
            localStorage.setItem('miniAppData', JSON.stringify(appData));
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ UI
            serverSaveAppState(appData);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
        function updateUI() {
            document.getElementById('balance').textContent = appData.user.balance;
            document.getElementById('tickets').textContent = appData.user.tickets;
            document.getElementById('userName').textContent = appData.user.name;
        }

        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –±–∞–∑–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function syncCurrentUserToUsers() {
            if (!appData.user.id) return;
            let user = appData.users.find(u => u.id === appData.user.id);
            if (!user) {
                user = {
                    id: appData.user.id,
                    name: appData.user.name,
                    balance: appData.user.balance,
                    tickets: appData.user.tickets,
                    joinDate: new Date().toISOString(),
                    lastActive: new Date().toISOString(),
                    bonusDays: appData.user.bonusDays,
                    usedPromos: appData.user.usedPromos,
                    inventory: appData.user.inventory || [],
                    activities: []
                };
                appData.users.push(user);
            } else {
                user.name = appData.user.name;
                user.balance = appData.user.balance;
                user.tickets = appData.user.tickets;
                user.bonusDays = appData.user.bonusDays;
                user.lastActive = new Date().toISOString();
                user.usedPromos = appData.user.usedPromos;
                user.inventory = appData.user.inventory || user.inventory;
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∞–¥–º–∏–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        function showAdminInterface() {
            document.getElementById('adminIndicator').style.display = 'block';
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
        function toggleAdminPanel() {
            if (!appData.user.isAdmin) return;
            
            const panel = document.getElementById('adminPanel');
            const isVisible = panel.classList.contains('show');
            
            if (isVisible) {
                panel.classList.remove('show');
                panel.style.display = 'none';
            } else {
                updateAdminStats();
                panel.style.display = 'block';
                panel.classList.add('show');
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∞–¥–º–∏–Ω–∫–∏
        function updateAdminStats() {
            syncCurrentUserToUsers();
            const today = new Date().toDateString();
            const activeToday = appData.users.filter(u => 
                u.lastActive && new Date(u.lastActive).toDateString() === today
            ).length;
            
            const totalBalance = appData.users.reduce((sum, u) => sum + (u.balance || 0), 0);
            const promosUsed = appData.promos.reduce((sum, p) => sum + p.uses, 0);
            
            document.getElementById('adminUserCount').textContent = appData.users.length;
            document.getElementById('adminActiveToday').textContent = activeToday;
            document.getElementById('adminTotalBalance').textContent = totalBalance;
            document.getElementById('adminPromosUsed').textContent = promosUsed;
            document.getElementById('adminPromoCount').textContent = appData.promos.length;
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞ (–∞–¥–º–∏–Ω)
        function showCreatePromo() {
            const promoCode = prompt('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, BONUS2024):');
            if (!promoCode) return;
            
            const reward = parseInt(prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–≥—Ä–∞–¥—É (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç):'));
            if (!reward || reward <= 0) {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞!');
                return;
            }
            
            const maxUses = parseInt(prompt('–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π:'));
            if (!maxUses || maxUses <= 0) {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π!');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π –ø—Ä–æ–º–æ–∫–æ–¥
            if (appData.promos.find(p => p.code === promoCode)) {
                alert('‚ùå –ü—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!');
                return;
            }
            
            appData.promos.push({
                code: promoCode,
                reward: reward,
                uses: 0,
                maxUses: maxUses,
                created: new Date().toISOString(),
                createdBy: appData.user.id
            });
            
            saveData();
            updateAdminStats();
            
            if (tg) {
                tg.showAlert(`‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ "${promoCode}" —Å–æ–∑–¥–∞–Ω!\n–ù–∞–≥—Ä–∞–¥–∞: ${reward} –º–æ–Ω–µ—Ç\n–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π: ${maxUses}`);
            } else {
                alert(`‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ "${promoCode}" —Å–æ–∑–¥–∞–Ω!\n–ù–∞–≥—Ä–∞–¥–∞: ${reward} –º–æ–Ω–µ—Ç\n–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π: ${maxUses}`);
            }
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
        function showUserManagement() {
            if (!appData.users.length) {
                alert('üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                return;
            }
            
            let usersList = '–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:\n\n';
            appData.users.forEach((user, index) => {
                const lastActive = user.lastActive ? 
                    new Date(user.lastActive).toLocaleDateString() : '–ù–∏–∫–æ–≥–¥–∞';
                usersList += `${index + 1}. ${user.name}\n`;
                usersList += `   ID: ${user.id}\n`;
                usersList += `   –ë–∞–ª–∞–Ω—Å: ${user.balance || 0}\n`;
                usersList += `   –ë–∏–ª–µ—Ç—ã: ${user.tickets || 0}\n`;
                usersList += `   –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${lastActive}\n\n`;
            });
            
            const userIndex = parseInt(prompt(usersList + '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:')) - 1;
            
            if (userIndex >= 0 && userIndex < appData.users.length) {
                manageSpecificUser(appData.users[userIndex]);
            }
        }

        function manageSpecificUser(user) {
            const action = prompt(`–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º ${user.name}:\n\n1 - –î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å\n2 - –°–ø–∏—Å–∞—Ç—å –±–∞–ª–∞–Ω—Å\n3 - –î–æ–±–∞–≤–∏—Ç—å –±–∏–ª–µ—Ç—ã\n4 - –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å\n5 - –£–¥–∞–ª–∏—Ç—å\n\n–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–µ–π—Å—Ç–≤–∏—è:`);
            
            switch(action) {
                case '1':
                    const addBalance = parseInt(prompt('–°–∫–æ–ª—å–∫–æ –º–æ–Ω–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å:'));
                    if (addBalance > 0) {
                        user.balance = (user.balance || 0) + addBalance;
                        saveData();
                        alert(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ ${addBalance} –º–æ–Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${user.name}`);
                    }
                    break;
                    
                case '2':
                    const subBalance = parseInt(prompt('–°–∫–æ–ª—å–∫–æ –º–æ–Ω–µ—Ç —Å–ø–∏—Å–∞—Ç—å:'));
                    if (subBalance > 0) {
                        user.balance = Math.max(0, (user.balance || 0) - subBalance);
                        saveData();
                        alert(`‚úÖ –°–ø–∏—Å–∞–Ω–æ ${subBalance} –º–æ–Ω–µ—Ç —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${user.name}`);
                    }
                    break;
                    
                case '3':
                    const addTickets = parseInt(prompt('–°–∫–æ–ª—å–∫–æ –±–∏–ª–µ—Ç–æ–≤ –¥–æ–±–∞–≤–∏—Ç—å:'));
                    if (addTickets > 0) {
                        user.tickets = (user.tickets || 0) + addTickets;
                        saveData();
                        alert(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ ${addTickets} –±–∏–ª–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${user.name}`);
                    }
                    break;
                    
                case '4':
                    user.blocked = !user.blocked;
                    saveData();
                    alert(`‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${user.name} ${user.blocked ? '–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω' : '—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω'}`);
                    break;
                    
                case '5':
                    if (confirm(`–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${user.name}?`)) {
                        appData.users = appData.users.filter(u => u.id !== user.id);
                        saveData();
                        alert(`‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${user.name} —É–¥–∞–ª–µ–Ω`);
                    }
                    break;
            }
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏
        function showPromoManagement() {
            if (!appData.promos.length) {
                alert('üé´ –ü—Ä–æ–º–æ–∫–æ–¥—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                return;
            }
            
            let promosList = '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏:\n\n';
            appData.promos.forEach((promo, index) => {
                promosList += `${index + 1}. ${promo.code}\n`;
                promosList += `   –ù–∞–≥—Ä–∞–¥–∞: ${promo.reward}\n`;
                promosList += `   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: ${promo.uses}/${promo.maxUses}\n`;
                promosList += `   –°–æ–∑–¥–∞–Ω: ${new Date(promo.created).toLocaleDateString()}\n\n`;
            });
            
            const promoIndex = parseInt(prompt(promosList + '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–∏–ª–∏ 0 –¥–ª—è –æ—Ç–º–µ–Ω—ã):')) - 1;
            
            if (promoIndex >= 0 && promoIndex < appData.promos.length) {
                if (confirm(`–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ "${appData.promos[promoIndex].code}"?`)) {
                    appData.promos.splice(promoIndex, 1);
                    saveData();
                    alert('‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ —É–¥–∞–ª–µ–Ω');
                }
            }
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∞–º–∏
        function showLinkManagement() {
            const platform = prompt('–ö–∞–∫—É—é —Å—Å—ã–ª–∫—É –∏–∑–º–µ–Ω–∏—Ç—å?\n\n1 - Telegram\n2 - Vk\n3 - Discord\n\n–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä:');
            
            let currentLink = '';
            let linkType = '';
            
            switch(platform) {
                case '1':
                    currentLink = appData.settings.downloadLinks.telegram;
                    linkType = 'telegram';
                    break;
                case '2':
                    currentLink = appData.settings.downloadLinks.appgallery;
                    linkType = 'appgallery';
                    break;
                case '3':
                    currentLink = appData.settings.downloadLinks.rustore;
                    linkType = 'rustore';
                    break;
                default:
                    return;
            }
            
            const newLink = prompt(`–¢–µ–∫—É—â–∞—è —Å—Å—ã–ª–∫–∞:\n${currentLink}\n\n–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é —Å—Å—ã–ª–∫—É:`);
            if (newLink) {
                appData.settings.downloadLinks[linkType] = newLink;
                saveData();
                alert('‚úÖ –°—Å—ã–ª–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
            }
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏
        function manageAdmins() {
            if (!appData.user.isAdmin) return;
            const action = prompt('–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏:\n\n1 - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤\n2 - –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∞ (–ø–æ Telegram ID)\n3 - –£–¥–∞–ª–∏—Ç—å –∞–¥–º–∏–Ω–∞ (–ø–æ Telegram ID)\n0 - –û—Ç–º–µ–Ω–∞');
            if (!action || action === '0') return;

            if (action === '1') {
                const list = appData.settings.adminIds && appData.settings.adminIds.length
                    ? appData.settings.adminIds.join(', ')
                    : '–ø—É—Å—Ç–æ';
                alert(`üëë –¢–µ–∫—É—â–∏–µ –∞–¥–º–∏–Ω—ã: ${list}`);
                return;
            }

            const idStr = prompt('–í–≤–µ–¥–∏—Ç–µ Telegram ID:');
            if (!idStr) return;
            const id = parseInt(idStr);
            if (isNaN(id)) {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π ID');
                return;
            }

            if (action === '2') {
                if (!appData.settings.adminIds.includes(id)) {
                    appData.settings.adminIds.push(id);
                    saveData();
                    alert('‚úÖ –ê–¥–º–∏–Ω –¥–æ–±–∞–≤–ª–µ–Ω');
                } else {
                    alert('‚ÑπÔ∏è –≠—Ç–æ—Ç ID —É–∂–µ –≤ —Å–ø–∏—Å–∫–µ –∞–¥–º–∏–Ω–æ–≤');
                }
            } else if (action === '3') {
                if (appData.settings.adminIds.includes(id)) {
                    appData.settings.adminIds = appData.settings.adminIds.filter(a => a !== id);
                    // –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º —Å–µ–±—è —É–¥–∞–ª–∏–ª –∏–∑ –∞–¥–º–∏–Ω–æ–≤
                    if (appData.user && appData.user.id === id) {
                        appData.user.isAdmin = false;
                        const panel = document.getElementById('adminPanel');
                        if (panel) {
                            panel.classList.remove('show');
                            panel.style.display = 'none';
                        }
                        const indicator = document.getElementById('adminIndicator');
                        if (indicator) indicator.style.display = 'none';
                    }
                    saveData();
                    alert('‚úÖ –ê–¥–º–∏–Ω —É–¥–∞–ª—ë–Ω');
                } else {
                    alert('‚ÑπÔ∏è –¢–∞–∫–æ–≥–æ ID –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ –∞–¥–º–∏–Ω–æ–≤');
                }
            }
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
        function exportData() {
            const data = {
                users: appData.users,
                promos: appData.promos,
                withdrawals: appData.withdrawals,
                statistics: {
                    totalUsers: appData.users.length,
                    totalBalance: appData.users.reduce((sum, u) => sum + (u.balance || 0), 0),
                    activeToday: appData.users.filter(u => 
                        u.lastActive && new Date(u.lastActive).toDateString() === new Date().toDateString()
                    ).length,
                    exportDate: new Date().toISOString()
                }
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            
            if (tg) {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –±–æ—Ç
                tg.sendData(dataStr);
            } else {
                // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º alert
                alert('üìä –î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞');
                console.log('–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö:', data);
            }
        }

        // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function openDownloadModal() {
            openModal('downloadModal');
        }

        function openBonusModal() {
            openModal('bonusModal');
            generateBonusCalendar();
        }

        function openPromoModal() {
            openModal('promoModal');
        }

        function openLeaderboard() {
            openModal('leaderboardModal');
            generateLeaderboard();
        }

        function openShop() {
            openModal('shopModal');
        }

        function openExchangeModal() {
            updateExchangeResult();
            openModal('exchangeModal');
        }

        function openWithdrawModal() {
            const el = document.getElementById('withdrawStatusText');
            if (el) {
                el.textContent = appData.settings.withdrawalsEnabled ? '–í—ã–≤–æ–¥—ã –≤–∫–ª—é—á–µ–Ω—ã' : '–í—ã–≤–æ–¥—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã';
            }
            openModal('withdrawModal');
        }

        // –•—Ä–∞–Ω–∏–ª–∏—â–µ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
        function openStorage() {
            if (!appData.user.inventory || appData.user.inventory.length === 0) {
                alert('üì¶ –í–∞—à–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø—É—Å—Ç–æ\n\n–ü–æ–∫—É–ø–∞–π—Ç–µ —Ç–æ–≤–∞—Ä—ã –≤ –º–∞–≥–∞–∑–∏–Ω–µ!');
                return;
            }
            
            let storageList = 'üì¶ –•–†–ê–ù–ò–õ–ò–©–ï –ü–†–ï–î–ú–ï–¢–û–í\n\n';
            
            const statusText = {
                pending: '‚è≥ –û–∂–∏–¥–∞–µ—Ç –≤—ã–≤–æ–¥–∞',
                processing: 'üîÑ –í –æ–±—Ä–∞–±–æ—Ç–∫–µ',
                delivered: '‚úÖ –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ'
            };
            
            appData.user.inventory.forEach((item, index) => {
                const purchaseDate = new Date(item.purchaseDate).toLocaleDateString();
                storageList += `${index + 1}. ${item.item}\n`;
                storageList += `   –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${item.category}\n`;
                storageList += `   –ö—É–ø–ª–µ–Ω–æ: ${purchaseDate}\n`;
                storageList += `   –°—Ç–∞—Ç—É—Å: ${statusText[item.status] || '‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}\n\n`;
            });
            
            storageList += '–í—Å–µ –≤—ã–≤–æ–¥—ã —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ —Å 00:00 –ø–æ 23:00\n\n';
            storageList += 'Powered by Gtech Mobile';
            
            alert(storageList);
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –±–æ–Ω—É—Å–æ–≤
        function generateBonusCalendar() {
            const bonusGrid = document.getElementById('bonusGrid');
            const rewards = [5, 10, 15, 15, 15, 15, 15, 15, 15];
            const today = new Date().getDate();
            
            bonusGrid.innerHTML = '';
            
            for (let i = 1; i <= 9; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'bonus-day';
                
                if (i <= appData.user.bonusDays) {
                    dayElement.classList.add('claimed');
                } else if (i === appData.user.bonusDays + 1 && canClaimBonus()) {
                    dayElement.classList.add('active');
                    dayElement.onclick = () => claimBonus(i);
                }
                
                dayElement.innerHTML = `
                    <div class="bonus-day-number">${i} –î–ï–ù–¨</div>
                    <div class="bonus-reward">
                        <div class="coin-icon">‚ÇΩ</div>
                        <span>${rewards[i-1]}</span>
                    </div>
                `;
                
                bonusGrid.appendChild(dayElement);
            }
            
            updateBonusTimer();
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–Ω—É—Å–∞
        function canClaimBonus() {
            const now = new Date();
            const lastBonus = appData.user.lastBonusDate ? new Date(appData.user.lastBonusDate) : null;
            
            if (!lastBonus) return true;
            
            const timeDiff = now.getTime() - lastBonus.getTime();
            const hoursDiff = timeDiff / (1000 * 3600);
            
            return hoursDiff >= 24;
        }

        // –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –±–æ–Ω—É—Å–∞
        function claimBonus(day) {
            if (!canClaimBonus()) {
                showNotification('‚ùå –ë–æ–Ω—É—Å –µ—â—ë –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω!', 'error');
                return;
            }
            
            const rewards = [5, 10, 15, 15, 15, 15, 15, 15, 15];
            const reward = rewards[day - 1];
            
            appData.user.balance += reward;
            appData.user.bonusDays = Math.max(appData.user.bonusDays, day);
            appData.user.lastBonusDate = new Date().toISOString();
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –∑–∞ —Å–µ—Ä–∏—é
            if (day === 7) {
                appData.user.balance += 50; // –ë–æ–Ω—É—Å –∑–∞ –Ω–µ–¥–µ–ª—é
                showNotification(`üéâ –ù–µ–¥–µ–ª—å–Ω—ã–π –±–æ–Ω—É—Å!\n–í—ã –ø–æ–ª—É—á–∏–ª–∏ ${reward} + 50 (–Ω–µ–¥–µ–ª—å–Ω—ã–π –±–æ–Ω—É—Å) = ${reward + 50} –º–æ–Ω–µ—Ç!`, 'success');
            } else if (day === 9) {
                appData.user.tickets += 1; // –ë–∏–ª–µ—Ç –∑–∞ –ø–æ–ª–Ω—É—é —Å–µ—Ä–∏—é
                showNotification(`üéä –ü–æ–ª–Ω–∞—è —Å–µ—Ä–∏—è!\n–í—ã –ø–æ–ª—É—á–∏–ª–∏ ${reward} –º–æ–Ω–µ—Ç + 1 –±–∏–ª–µ—Ç!`, 'success');
            } else {
                showNotification(`üéâ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å!\n–í—ã –ø–æ–ª—É—á–∏–ª–∏ ${reward} –º–æ–Ω–µ—Ç!`, 'success');
            }
            
            syncCurrentUserToUsers();
            saveData();
            updateUI();
            generateBonusCalendar();
            logUserActivity(`bonus_day_${day}`);
        }

        // –£–ª—É—á—à–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        window.addEventListener('load', async () => {
            await loadData();
            // –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç—É—Å –∞–¥–º–∏–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            if (appData.user && appData.user.id) {
                const isAdminNow = Array.isArray(appData.settings.adminIds) && appData.settings.adminIds.includes(appData.user.id);
                if (isAdminNow && !appData.user.isAdmin) {
                    appData.user.isAdmin = true;
                    showAdminInterface();
                } else if (!isAdminNow && appData.user.isAdmin) {
                    appData.user.isAdmin = false;
                    const panel = document.getElementById('adminPanel');
                    if (panel) {
                        panel.classList.remove('show');
                        panel.style.display = 'none';
                    }
                    const indicator = document.getElementById('adminIndicator');
                    if (indicator) indicator.style.display = 'none';
                }
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑—É –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
            if (appData.user.id) {
                let user = appData.users.find(u => u.id === appData.user.id);
                if (!user) {
                    user = {
                        id: appData.user.id,
                        name: appData.user.name,
                        balance: appData.user.balance,
                        tickets: appData.user.tickets,
                        joinDate: new Date().toISOString(),
                        lastActive: new Date().toISOString(),
                        bonusDays: appData.user.bonusDays,
                        usedPromos: appData.user.usedPromos,
                        inventory: appData.user.inventory || [],
                        activities: []
                    };
                    appData.users.push(user);
                } else {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    user.name = appData.user.name;
                    user.lastActive = new Date().toISOString();
                    user.balance = appData.user.balance;
                    user.tickets = appData.user.tickets;
                }
                saveData();
            }

            // –ü–æ–∫–∞–∑ –ø—Ä–æ–º–æ–∫–æ–¥–∞ –ø–æ –æ–¥–æ–±—Ä–µ–Ω–Ω–æ–º—É –≤—ã–≤–æ–¥—É –ø—Ä–∏ –≤—Ö–æ–¥–µ
            if (appData.user.id && Array.isArray(appData.withdrawals)) {
                const pendingNotifies = appData.withdrawals.filter(w => w.userId === appData.user.id && w.status === 'approved' && !w.notified);
                if (pendingNotifies.length > 0) {
                    const last = pendingNotifies[pendingNotifies.length - 1];
                    if (last.promoCode) {
                        showNotification(`‚úÖ –í–∞—à –≤—ã–≤–æ–¥ –æ–¥–æ–±—Ä–µ–Ω!\n–ü—Ä–æ–º–æ–∫–æ–¥: ${last.promoCode}`, 'success');
                        last.notified = true;
                        saveData();
                    }
                }
            }

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
            setInterval(() => {
                if (document.getElementById('leaderboardModal').style.display === 'flex') {
                    generateLeaderboard();
                }
            }, 30000); // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        });

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞ –±–æ–Ω—É—Å–∞
        function updateBonusTimer() {
            const timerElement = document.getElementById('bonusTimer');
            if (!appData.user.lastBonusDate) {
                timerElement.textContent = '–ë–æ–Ω—É—Å –¥–æ—Å—Ç—É–ø–µ–Ω —Å–µ–π—á–∞—Å!';
                return;
            }
            
            const lastBonus = new Date(appData.user.lastBonusDate);
            const nextBonus = new Date(lastBonus.getTime() + 24 * 60 * 60 * 1000);
            const now = new Date();
            
            if (now >= nextBonus) {
                timerElement.textContent = '–ë–æ–Ω—É—Å –¥–æ—Å—Ç—É–ø–µ–Ω —Å–µ–π—á–∞—Å!';
                return;
            }
            
            const timeDiff = nextBonus.getTime() - now.getTime();
            const hours = Math.floor(timeDiff / (1000 * 60 * 60));
            const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);
            
            timerElement.textContent = `–ú–æ–∂–Ω–æ –∑–∞–±—Ä–∞—Ç—å –±–æ–Ω—É—Å —á–µ—Ä–µ–∑: ${hours}—á. ${minutes}–º. ${seconds}—Å–µ–∫.`;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
        function generateLeaderboard() {
            // –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            syncCurrentUserToUsers();
            const leaderboardList = document.getElementById('leaderboardList');
            leaderboardList.innerHTML = '';
            
            // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ (—Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ + —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
            let allPlayers = [...appData.leaderboard]; // –ù–∞—á–∞–ª—å–Ω—ã–µ —Ñ–µ–π–∫–æ–≤—ã–µ –∏–≥—Ä–æ–∫–∏
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            appData.users.forEach(user => {
                if (user.balance > 0) {
                    // –£–¥–∞–ª—è–µ–º —Ñ–µ–π–∫–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –µ—Å–ª–∏ –µ—Å—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π —Å —Ç–∞–∫–∏–º –∂–µ –∏–º–µ–Ω–µ–º
                    allPlayers = allPlayers.filter(p => p.name.toUpperCase() !== user.name.toUpperCase());
                    
                    allPlayers.push({
                        name: user.name.toUpperCase(),
                        score: user.balance,
                        avatar: getUserAvatar(user.name),
                        isReal: true,
                        id: user.id,
                        lastActive: user.lastActive
                    });
                }
            });
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –±–∞–ª–∞–Ω—Å–∞
            allPlayers.sort((a, b) => {
                if (b.score !== a.score) return b.score - a.score;
                // –ü—Ä–∏ —Ä–∞–≤–Ω–æ–º –±–∞–ª–∞–Ω—Å–µ —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (—Ä–µ–∞–ª—å–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ –≤—ã—à–µ)
                if (a.isReal && !b.isReal) return -1;
                if (!a.isReal && b.isReal) return 1;
                return 0;
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ø-50 –∏–≥—Ä–æ–∫–æ–≤
            const topPlayers = allPlayers.slice(0, 50);
            
            topPlayers.forEach((player, index) => {
                const playerElement = document.createElement('div');
                playerElement.className = 'leaderboard-item';
                
                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if (player.id === appData.user.id) {
                    playerElement.style.background = 'linear-gradient(45deg, rgba(241, 196, 15, 0.2), rgba(243, 156, 18, 0.2))';
                    playerElement.style.border = '2px solid #f1c40f';
                }
                
                // –û—Å–æ–±—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–æ–ø-3
                let rankStyle = '';
                if (index === 0) rankStyle = 'color: #f1c40f; font-size: 20px;'; // –ó–æ–ª–æ—Ç–æ
                else if (index === 1) rankStyle = 'color: #95a5a6; font-size: 18px;'; // –°–µ—Ä–µ–±—Ä–æ  
                else if (index === 2) rankStyle = 'color: #e67e22; font-size: 16px;'; // –ë—Ä–æ–Ω–∑–∞
                
                playerElement.innerHTML = `
                    <div class="rank" style="${rankStyle}">#${index + 1}</div>
                    <div class="player-avatar">${player.avatar}</div>
                    <div class="player-info">
                        <div class="player-name">
                            ${player.name}
                            ${player.isReal ? '<span style="color: #2ecc71; font-size: 12px;">‚óè</span>' : '<span style="color: #95a5a6; font-size: 12px;">‚óã</span>'}
                        </div>
                        <div class="player-score">
                            <div class="coin-icon">‚ÇΩ</div>
                            <span>+${player.score}</span>
                            ${player.lastActive ? `<span style="font-size: 10px; color: #95a5a6; margin-left: 5px;">${getTimeAgo(player.lastActive)}</span>` : ''}
                        </div>
                    </div>
                `;
                
                leaderboardList.appendChild(playerElement);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏–≥—Ä–æ–∫–æ–≤
            const modalTitle = document.querySelector('#leaderboardModal .modal-title');
            if (modalTitle) {
                modalTitle.textContent = `–¢–û–ü –ê–ö–¢–ò–í–ù–´–• –ò–ì–†–û–ö–û–í (${topPlayers.length})`;
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getUserAvatar(name) {
            const avatars = ['üéÆ', 'üíé', 'üëî', 'üíÄ', '‚öΩ', 'üéØ', 'üöÄ', '‚≠ê', 'üî•', 'üí´', 'üé™', 'üé®', 'üé≠', 'üé™', 'üèÜ'];
            const nameHash = name.split('').reduce((hash, char) => hash + char.charCodeAt(0), 0);
            return avatars[nameHash % avatars.length];
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –≤—Ä–µ–º–µ–Ω–∏ "–Ω–∞–∑–∞–¥"
        function getTimeAgo(dateString) {
            const now = new Date();
            const date = new Date(dateString);
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);
            
            if (diffMins < 1) return '—Å–µ–π—á–∞—Å';
            if (diffMins < 60) return `${diffMins}–º`;
            if (diffHours < 24) return `${diffHours}—á`;
            if (diffDays < 7) return `${diffDays}–¥`;
            return '–¥–∞–≤–Ω–æ';
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –ª–æ–≥–æ—Ç–∏–ø—É (–æ—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–∞–∫ –ø–∞—Å—Ö–∞–ª–∫—É)
        function handleLogoClick() {
            if (appData.user.isAdmin) {
                toggleAdminPanel();
                return;
            }
            
            appData.adminClicks++;
            if (appData.adminClicks >= 7) {
                alert('üéä –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!\n\n–í—ã –Ω–∞—à–ª–∏ —Å–µ–∫—Ä–µ—Ç–Ω—É—é –ø–∞—Å—Ö–∞–ª–∫—É!\n\n+50 –º–æ–Ω–µ—Ç –∫ –±–∞–ª–∞–Ω—Å—É!');
                appData.user.balance += 50;
                appData.adminClicks = 0;
                syncCurrentUserToUsers();
                saveData();
                updateUI();
                logUserActivity('easter_egg');
            } else {
                const remaining = 7 - appData.adminClicks;
                if (remaining <= 3) {
                    // –ü–æ–¥—Å–∫–∞–∑–∫–∞ –∫–æ–≥–¥–∞ –æ—Å—Ç–∞–ª–æ—Å—å –º–∞–ª–æ –∫–ª–∏–∫–æ–≤
                    console.log(`–û—Å—Ç–∞–ª–æ—Å—å –∫–ª–∏–∫–æ–≤: ${remaining}`);
                }
            }
        }

        // –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
        function activatePromo() {
            const promoCode = document.getElementById('promoInput').value.trim().toUpperCase();
            
            if (!promoCode) {
                showNotification('‚ùå –í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥!', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –ª–∏ –ø—Ä–æ–º–æ–∫–æ–¥
            if (appData.user.usedPromos.includes(promoCode)) {
                showNotification('‚ùå –ü—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω!', 'error');
                return;
            }
            
            // –ò—â–µ–º –ø—Ä–æ–º–æ–∫–æ–¥
            const promo = appData.promos.find(p => p.code.toUpperCase() === promoCode);
            
            if (!promo) {
                showNotification('‚ùå –ü—Ä–æ–º–æ–∫–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–∏–º–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
            if (promo.uses >= promo.maxUses) {
                showNotification('‚ùå –ü—Ä–æ–º–æ–∫–æ–¥ –∏—Å—á–µ—Ä–ø–∞–Ω!', 'error');
                return;
            }
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø—Ä–æ–º–æ–∫–æ–¥
            appData.user.balance += promo.reward;
            appData.user.usedPromos.push(promoCode);
            promo.uses++;
            
            syncCurrentUserToUsers();
            saveData();
            updateUI();
            closeModal('promoModal');
            logUserActivity(`promo_${promoCode}`);
            
            showNotification(`üéâ –ü—Ä–æ–º–æ–∫–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!\n–ü–æ–ª—É—á–µ–Ω–æ ${promo.reward} –º–æ–Ω–µ—Ç!`, 'success');
            document.getElementById('promoInput').value = '';
        }

        // –û–±–º–µ–Ω —Ä—É–±–ª–µ–π –Ω–∞ –±–∏–ª–µ—Ç—ã
        function updateExchangeResult() {
            const input = document.getElementById('exchangeAmountInput');
            const res = document.getElementById('exchangeResult');
            if (!input || !res) return;
            const amount = parseInt(input.value || '0');
            if (isNaN(amount) || amount <= 0) {
                res.textContent = '–í—ã –ø–æ–ª—É—á–∏—Ç–µ: 0 –±–∏–ª–µ—Ç–æ–≤';
                return;
            }
            const tickets = Math.floor(amount / 10) * 2;
            res.textContent = `–í—ã –ø–æ–ª—É—á–∏—Ç–µ: ${tickets} –±–∏–ª–µ—Ç–æ–≤`;
        }

        function performExchange() {
            const input = document.getElementById('exchangeAmountInput');
            const amount = parseInt(input.value || '0');
            if (isNaN(amount) || amount < 100) {
                showNotification('‚ùå –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –æ–±–º–µ–Ω–∞ 100 ‚ÇΩ', 'error');
                return;
            }
            if (amount % 10 !== 0) {
                showNotification('‚ùå –°—É–º–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫—Ä–∞—Ç–Ω–∞ 10 ‚ÇΩ', 'error');
                return;
            }
            if (amount > appData.user.balance) {
                showNotification('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –æ–±–º–µ–Ω–∞', 'error');
                return;
            }
            const tickets = (amount / 10) * 2;
            appData.user.balance -= amount;
            appData.user.tickets += tickets;
            syncCurrentUserToUsers();
            saveData();
            updateUI();
            closeModal('exchangeModal');
            logUserActivity(`exchange_${amount}`);
            showNotification(`‚úÖ –û–±–º–µ–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω!\n–°–ø–∏—Å–∞–Ω–æ ${amount} ‚ÇΩ, –ø–æ–ª—É—á–µ–Ω–æ ${tickets} –±–∏–ª–µ—Ç–æ–≤`, 'success');
            input.value = '';
            updateExchangeResult();
        }

        // –í—ã–≤–æ–¥ –±–∏–ª–µ—Ç–æ–≤
        function submitWithdrawalRequest() {
            if (!appData.settings.withdrawalsEnabled) {
                showNotification('‚ùå –í—ã–≤–æ–¥—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã', 'error');
                return;
            }
            const nickname = document.getElementById('withdrawNicknameInput').value.trim();
            const amount = parseInt(document.getElementById('withdrawTicketsInput').value || '0');
            if (!nickname) {
                showNotification('‚ùå –£–∫–∞–∂–∏—Ç–µ –Ω–∏–∫', 'error');
                return;
            }
            if (isNaN(amount) || amount < 50) {
                showNotification('‚ùå –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ 50 –±–∏–ª–µ—Ç–æ–≤', 'error');
                return;
            }
            const request = {
                id: 'wd_' + Date.now() + '_' + Math.floor(Math.random() * 100000),
                userId: appData.user.id,
                userName: appData.user.name,
                nickname: nickname,
                tickets: amount,
                status: 'pending',
                createdAt: new Date().toISOString(),
                promoCode: null,
                notified: false
            };
            appData.withdrawals.push(request);
            saveData();
            closeModal('withdrawModal');
            logUserActivity('withdraw_request');
            showNotification('‚úÖ –ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –û–∂–∏–¥–∞–π—Ç–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è', 'success');
            document.getElementById('withdrawNicknameInput').value = '';
            document.getElementById('withdrawTicketsInput').value = '';
        }

        // –ê–¥–º–∏–Ω: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ –Ω–∞ –≤—ã–≤–æ–¥
        function showWithdrawRequests() {
            if (!appData.user.isAdmin) return;
            if (!appData.withdrawals || appData.withdrawals.length === 0) {
                alert('üí∏ –ó–∞—è–≤–æ–∫ –Ω–∞ –≤—ã–≤–æ–¥ –Ω–µ—Ç');
                return;
            }
            const statusText = { pending: '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ', approved: '‚úÖ –û–¥–æ–±—Ä–µ–Ω–æ', declined: '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ' };
            let list = '–ó–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–≤–æ–¥:\n\n';
            appData.withdrawals.forEach((w, i) => {
                list += `${i + 1}. ${w.userName} (${w.nickname}) ‚Äî ${w.tickets} –±–∏–ª–µ—Ç–æ–≤ ‚Äî ${statusText[w.status]}\n`;
                list += `   –î–∞—Ç–∞: ${new Date(w.createdAt).toLocaleString()}${w.promoCode ? `\n   –ü—Ä–æ–º–æ–∫–æ–¥: ${w.promoCode}` : ''}\n\n`;
            });
            const idx = parseInt(prompt(list + '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∑–∞—è–≤–∫–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:')) - 1;
            if (!(idx >= 0 && idx < appData.withdrawals.length)) return;
            const req = appData.withdrawals[idx];
            if (req.status === 'pending') {
                const action = prompt(`–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–æ–π ${idx + 1}:\n\n1 - –û–¥–æ–±—Ä–∏—Ç—å (–≤–≤–µ—Å—Ç–∏ –ø—Ä–æ–º–æ–∫–æ–¥)\n2 - –û—Ç–∫–ª–æ–Ω–∏—Ç—å\n0 - –û—Ç–º–µ–Ω–∞`);
                if (action === '1') {
                    const code = prompt('–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:');
                    if (!code) return;
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –±–∏–ª–µ—Ç–æ–≤ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –º–æ–º–µ–Ω—Ç –æ–¥–æ–±—Ä–µ–Ω–∏—è
                    const user = appData.users.find(u => u.id === req.userId);
                    const available = user ? (user.tickets || 0) : 0;
                    if (available < req.tickets) {
                        alert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∏–ª–µ—Ç–æ–≤ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏—è');
                        return;
                    }
                    // –°–ø–∏—Å–∞–Ω–∏–µ –±–∏–ª–µ—Ç–æ–≤
                    user.tickets = available - req.tickets;
                    if (appData.user.id === req.userId) {
                        appData.user.tickets = user.tickets;
                        updateUI();
                    }
                    // –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ–¥–æ–±—Ä–µ–Ω–Ω—É—é –∑–∞—è–≤–∫—É, —É–¥–∞–ª—è–µ–º –µ—ë –∏–∑ —Å–ø–∏—Å–∫–∞
                    appData.withdrawals.splice(idx, 1);
                    saveData();
                    alert(`‚úÖ –ó–∞—è–≤–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∞. –ü—Ä–æ–º–æ–∫–æ–¥: ${code}`);
                } else if (action === '2') {
                    // –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–∫–ª–æ–Ω—ë–Ω–Ω—É—é –∑–∞—è–≤–∫—É, —É–¥–∞–ª—è–µ–º –µ—ë –∏–∑ —Å–ø–∏—Å–∫–∞
                    appData.withdrawals.splice(idx, 1);
                    saveData();
                    alert('‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ –∏ —É–¥–∞–ª–µ–Ω–∞ –∏–∑ —Å–ø–∏—Å–∫–∞');
                }
            } else {
                alert(`–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏: ${req.status.toUpperCase()}${req.promoCode ? `\n–ü—Ä–æ–º–æ–∫–æ–¥: ${req.promoCode}` : ''}`);
            }
        }

        function toggleWithdrawals() {
            if (!appData.user.isAdmin) return;
            appData.settings.withdrawalsEnabled = !appData.settings.withdrawalsEnabled;
            saveData();
            alert(`üîå –í—ã–≤–æ–¥—ã —Ç–µ–ø–µ—Ä—å: ${appData.settings.withdrawalsEnabled ? '–≤–∫–ª—é—á–µ–Ω—ã' : '–æ—Ç–∫–ª—é—á–µ–Ω—ã'}`);
        }

        // –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function showNotification(message, type = 'info') {
            if (tg) {
                if (type === 'error') {
                    tg.showAlert(message);
                } else {
                    tg.showPopup({
                        title: type === 'success' ? '–£—Å–ø–µ—Ö!' : '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',
                        message: message,
                        buttons: [{type: 'ok'}]
                    });
                }
            } else {
                alert(message);
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è (—Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏)
        function downloadTelegram() {
            const link = appData.settings.downloadLinks.telegram;
            if (tg) {
                tg.openLink(link);
            } else {
                window.open(link, '_blank');
            }
            
            // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
            logUserActivity('download_telegram');
        }

        function downloadAppGallery() {
            const link = appData.settings.downloadLinks.appgallery;
            if (tg) {
                tg.openLink(link);
            } else {
                window.open(link, '_blank');
            }
            
            logUserActivity('download_appgallery');
        }

        function downloadRuStore() {
            const link = appData.settings.downloadLinks.rustore;
            if (tg) {
                tg.openLink(link);
            } else {
                window.open(link, '_blank');
            }
            
            logUserActivity('download_rustore');
        }

        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function logUserActivity(action) {
            if (!appData.user.id) return;
            
            const user = appData.users.find(u => u.id === appData.user.id);
            if (user) {
                user.lastActive = new Date().toISOString();
                if (!user.activities) user.activities = [];
                user.activities.push({
                    action: action,
                    timestamp: new Date().toISOString()
                });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
                if (user.activities.length > 50) {
                    user.activities = user.activities.slice(-50);
                }
                
                saveData();
            }
        }

        // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞
        function openCategory(category) {
            const categoryNames = {
                transport: '–£–ù–ò–ö–ê–õ–¨–ù–´–ô –¢–†–ê–ù–°–ü–û–†–¢',
                skins: '–£–ù–ò–ö–ê–õ–¨–ù–´–ï –°–ö–ò–ù–´', 
                items: '–£–ù–ò–ö–ê–õ–¨–ù–´–ï –ü–†–ï–î–ú–ï–¢–´',
                currency: '–í–ò–†–¢–£–ê–õ–¨–ù–ê–Ø –í–ê–õ–Æ–¢–ê'
            };
            
            alert(`üõçÔ∏è ${categoryNames[category]}\n\n–í—Å–µ –≤—ã–≤–æ–¥—ã —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ —Å 00:00 –ø–æ 23:00\n\nPowered by Gtech Mobile`);
        }

        // –ê–¥–º–∏–Ω —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
        function resetLeaderboard() {
            if (!appData.user.isAdmin) {
                showNotification('‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞!', 'error');
                return;
            }
            
            const confirmation = confirm('üîÑ –°–ë–†–û–° –õ–ò–î–ï–†–ë–û–†–î–ê\n\n–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ:\n\n1. –û–±–Ω—É–ª–∏—Ç—å –±–∞–ª–∞–Ω—Å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π\n2. –°–±—Ä–æ—Å–∏—Ç—å –±–æ–Ω—É—Å–Ω—ã–µ –¥–Ω–∏\n3. –û—á–∏—Å—Ç–∏—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏\n4. –ù–∞—á–∞—Ç—å —Ç–æ–ø —Å –Ω—É–ª—è\n\n–≠–¢–û –î–ï–ô–°–¢–í–ò–ï –ù–ï–û–ë–†–ê–¢–ò–ú–û!');
            
            if (!confirmation) return;
            
            const doubleConfirm = prompt('–î–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–≤–µ–¥–∏—Ç–µ "RESET":');
            if (doubleConfirm !== 'RESET') {
                alert('‚ùå –°–±—Ä–æ—Å –æ—Ç–º–µ–Ω–µ–Ω');
                return;
            }
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            appData.users.forEach(user => {
                user.balance = 0;
                user.tickets = 0;
                user.bonusDays = 0;
                user.lastBonusDate = null;
                user.usedPromos = [];
                user.inventory = [];
                user.activities = [];
            });
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            appData.user.balance = 0;
            appData.user.tickets = 0;
            appData.user.bonusDays = 0;
            appData.user.lastBonusDate = null;
            appData.user.usedPromos = [];
            appData.user.inventory = [];
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –±–∞–∑–æ–≤—ã–π –ª–∏–¥–µ—Ä–±–æ—Ä–¥
            appData.leaderboard = [
                { name: 'ZUZULKO', score: 787, avatar: 'üéÆ' },
                { name: 'SUXIZSCX', score: 214, avatar: 'üíé' },
                { name: 'GIG0344', score: 206, avatar: 'üëî' },
                { name: 'OLEG ALEKSEEV', score: 153, avatar: 'üíÄ' },
                { name: 'WERT4567889', score: 132, avatar: '‚öΩ' }
            ];
            
            saveData();
            updateUI();
            generateBonusCalendar();
            generateLeaderboard();
            updateAdminStats();
            
            showNotification('‚úÖ –õ–∏–¥–µ—Ä–±–æ—Ä–¥ —É—Å–ø–µ—à–Ω–æ —Å–±—Ä–æ—à–µ–Ω!\n\n–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞—á–∏–Ω–∞—é—Ç —Å –Ω—É–ª—è.', 'success');
        }

        // –ê–¥–º–∏–Ω —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
        function manageLeaderboard() {
            if (!appData.user.isAdmin) return;
            
            const action = prompt(`üèÜ –£–ü–†–ê–í–õ–ï–ù–ò–ï –õ–ò–î–ï–†–ë–û–†–î–û–ú\n\n1 - –î–æ–±–∞–≤–∏—Ç—å —Ñ–µ–π–∫–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞\n2 - –£–¥–∞–ª–∏—Ç—å —Ñ–µ–π–∫–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞\n3 - –ò–∑–º–µ–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å –∏–≥—Ä–æ–∫–∞\n4 - –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞\n5 - –û–±–Ω–æ–≤–∏—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏\n\n–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–µ–π—Å—Ç–≤–∏—è:`);
            
            switch(action) {
                case '1':
                    addFakePlayer();
                    break;
                case '2':
                    removeFakePlayer();
                    break;
                case '3':
                    editPlayerBalance();
                    break;
                case '4':
                    resetLeaderboard();
                    break;
                case '5':
                    generateLeaderboard();
                    showNotification('‚úÖ –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
                    break;
            }
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–µ–π–∫–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞
        function addFakePlayer() {
            const name = prompt('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏–≥—Ä–æ–∫–∞:');
            if (!name) return;
            
            const score = parseInt(prompt('–í–≤–µ–¥–∏—Ç–µ –±–∞–ª–∞–Ω—Å:'));
            if (!score || score < 0) return;
            
            const avatars = ['üéÆ', 'üíé', 'üëî', 'üíÄ', '‚öΩ', 'üéØ', 'üöÄ', '‚≠ê', 'üî•', 'üí´'];
            const avatar = avatars[Math.floor(Math.random() * avatars.length)];
            
            appData.leaderboard.push({
                name: name.toUpperCase(),
                score: score,
                avatar: avatar,
                isReal: false
            });
            
            saveData();
            generateLeaderboard();
            showNotification(`‚úÖ –ò–≥—Ä–æ–∫ ${name} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –ª–∏–¥–µ—Ä–±–æ—Ä–¥`, 'success');
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–µ–π–∫–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞
        function removeFakePlayer() {
            const fakePlayersOnly = appData.leaderboard.filter(p => !p.isReal);
            if (fakePlayersOnly.length === 0) {
                alert('‚ùå –ù–µ—Ç —Ñ–µ–π–∫–æ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è');
                return;
            }
            
            let playersList = '–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:\n\n';
            fakePlayersOnly.forEach((player, index) => {
                playersList += `${index + 1}. ${player.name} (${player.score})\n`;
            });
            
            const playerIndex = parseInt(prompt(playersList + '\n–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä:')) - 1;
            if (playerIndex >= 0 && playerIndex < fakePlayersOnly.length) {
                const playerToRemove = fakePlayersOnly[playerIndex];
                appData.leaderboard = appData.leaderboard.filter(p => p !== playerToRemove);
                saveData();
                generateLeaderboard();
                showNotification(`‚úÖ –ò–≥—Ä–æ–∫ ${playerToRemove.name} —É–¥–∞–ª–µ–Ω`, 'success');
            }
        }

        // –ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∏–≥—Ä–æ–∫–∞
        function editPlayerBalance() {
            let allPlayers = [...appData.leaderboard];
            appData.users.forEach(user => {
                if (user.balance > 0) {
                    allPlayers.push({
                        name: user.name,
                        score: user.balance,
                        isReal: true,
                        userData: user
                    });
                }
            });
            
            if (allPlayers.length === 0) {
                alert('‚ùå –ù–µ—Ç –∏–≥—Ä–æ–∫–æ–≤ –≤ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–µ');
                return;
            }
            
            let playersList = '–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞:\n\n';
            allPlayers.forEach((player, index) => {
                playersList += `${index + 1}. ${player.name} - ${player.score} ${player.isReal ? '(—Ä–µ–∞–ª—å–Ω—ã–π)' : '(—Ñ–µ–π–∫–æ–≤—ã–π)'}\n`;
            });
            
            const playerIndex = parseInt(prompt(playersList + '\n–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä:')) - 1;
            if (playerIndex >= 0 && playerIndex < allPlayers.length) {
                const player = allPlayers[playerIndex];
                const newBalance = parseInt(prompt(`–ù–æ–≤—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è ${player.name}:`));
                
                if (newBalance >= 0) {
                    if (player.isReal && player.userData) {
                        player.userData.balance = newBalance;
                        if (player.userData.id === appData.user.id) {
                            appData.user.balance = newBalance;
                            updateUI();
                        }
                    } else {
                        // –§–µ–π–∫–æ–≤—ã–π –∏–≥—Ä–æ–∫
                        const fakePlayer = appData.leaderboard.find(p => p.name === player.name);
                        if (fakePlayer) fakePlayer.score = newBalance;
                    }
                    
                    saveData();
                    generateLeaderboard();
                    showNotification(`‚úÖ –ë–∞–ª–∞–Ω—Å –∏–≥—Ä–æ–∫–∞ ${player.name} –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ ${newBalance}`, 'success');
                }
            }
        }

        function closeApp() {
            if (tg) {
                tg.close();
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
        setInterval(updateBonusTimer, 1000);

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏/–ø–µ—Ä–µ—Ö–æ–¥–µ
        window.addEventListener('beforeunload', () => {
            if (appData.user.id) {
                const user = appData.users.find(u => u.id === appData.user.id);
                if (user) {
                    user.balance = appData.user.balance;
                    user.tickets = appData.user.tickets;
                    user.bonusDays = appData.user.bonusDays;
                    user.usedPromos = appData.user.usedPromos;
                    user.inventory = appData.user.inventory;
                    user.lastActive = new Date().toISOString();
                }
            }
            saveData();
        });

        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(() => {
            if (appData.user.id) {
                syncCurrentUserToUsers();
                saveData();
            }
        }, 30000);

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        document.querySelectorAll('.modal-content').forEach(content => {
            content.addEventListener('click', (e) => {
                e.stopPropagation();
            });
        });
    </script>
</body>
</html>